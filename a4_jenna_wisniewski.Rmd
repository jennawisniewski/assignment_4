---
title: "Assignment 4"
author: "Jenna Wisniewski"
date: "11/17/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(lubridate)
library(janitor)
library(here)
library(kableExtra)
library(ggbeeswarm)
library(effsize)
library(broom)
```


```{r}
##Read in the data
hares <- read_csv(here("data","bonanza_hares.csv"))
```
## 1.Introduction 
This report provides an exploratory overview of differences in penguin sizes for three species of nesting adult penguins (gentoo, chinstrap and AdÃ©lie) observed on islands within the Palmer Archipelago from 2007 - 2009 (Gorman et al. 2014). Specifically, flipper lengths are compared across the three species, and the relationship(s) between flipper length and body mass explored. *Note: moving forward we'll work on introductions that motivate the work (e.g. "What's the problem & why does this matter?") but for now a cursory overview of what's included is fine...*

## 2.Data and Analyses
Penguin structural size measurements were collected and made available by Dr. Kristen Gorman and colleagues at the Palmer Station Long Term Ecological Research (LTER) network site in Palmer Archipelago, Antarctica (see map from Gorman et al. (2014) in Figure 1). The data contain observations for 344 unique nesting penguins, collected over three seasons (2007, 2008, 2009). Following exploratory data visualization, flipper lengths between male and female penguins are by two-sample t-tests using a significance level ($\alpha$) of 0.05 throughout. Differences between groups are described by Cohen's *d* effect size. The relationship between flipper length and body mass is explored by simple linear regression. All analyses are in R version 4.0.2 using RStudio version 1.3.1056. 

## 3.Exploratory Findings

### a. Annual Juvenile Hare Trap Counts
Juvenile hare trappings were totaled for each year from 1999 to 2012.
```{r}
##Taking the hare data I originally read in, changing the date to mdy format, creating a year column, filtering the age so that only juveniles will remain, and creating a count of juveniles trapped per year
hares_counts <- hares %>% 
  mutate(date = mdy(date), .keep = 'unused') %>% 
  mutate(year = year(date)) %>% 
  filter(age == "j") %>% 
   count(year)

##Plotting the number of juvenile hare trapping per year
ggplot() + geom_col(data = hares_counts,aes(x = year, y = n), fill= "cadetblue4") + scale_x_continuous(breaks = c(1999, 2001, 2003, 2005, 2007, 2009, 2011))+labs(x="Year", y="Number of juvenile hare trappings")+
  theme_minimal()


```

**Figure 1.** Total number of trapped juvenile Snowshoe hares at Bonanza Creek from years 1999 to 2012, excluding 2002 and 2009. Data: Kielland et. al.(2017)

The graph shows a higher amount of trapping in earlier years. The first year, 1999, had the maximum count if 126. The minimum count was in 2010 with 2 trappings. The mean number of counts for all years was 31.5. In order to standardize the count of this population in future analyses, the same number of traps should be set for the same number of days each year. 

### b.Visualize Juvenile Hare Weights

```{r}
##Taking the hare data so that only juveniles remain, and the columns sex, grid and weight
hare_data <- hares %>% 
  filter(age == "j") %>% 
  select("sex","grid","weight")

##Plotting the weight of each sex of penguin by the grid location

ggplot(data = hare_data, aes(x = sex, y = weight, na.rm = TRUE)) +
  geom_beeswarm(aes(color = grid,)) +
  facet_wrap(~grid) +
   scale_color_manual(values = c("goldenrod2", "lightblue", "olivedrab"))+
  geom_boxplot(fill = NA, width = 0.6) +
   stat_summary(fun=mean, 
               geom="point", 
               shape=20, 
               size=4, 
               color="black", 
               fill="black") +
  labs(x = "Sex", y = "Weight (grams)")

 
```


**Figure 2** Weight observations (gm) for juvenile snowshoe hares by sex and at the three different grid sites(bons, bonmat, and bonrip). Gold (bons), blue (bonmat) and green (bonrip) points indicate individual observations weight (grams) of an juvenile snowshoe hares by sex. Box endpoints indicate the 25^th^ and 75^th^ percentile values; the black line and black point within the box indicate the median and mean value for each species, respectively. Data: Kielland et. al.(2017).



Distribution of weight for all three sites was relatively normal and symmetric, however it looks like more data is needed, especially in the bons and bonmat to further determine this. Across all sites, the male snowshoe hare's weight has both a higher median and mean. The juvenile hares at the bonbs site have a higher mean and median than the other sites, the bonmat and bonrip sites have very close means when comparing males and females. 



### c.Juvenile Weight Comparison


**Table 1** Descriptive statistics (mean, standard deviation, and sample size) for the weight(grams) across sex in juvenile snowshoe hares Data: Kielland et. al.(2017).
```{r}
##I am creating a summary table which will give me the mean, standard deviation, and sample size of the weight of the hares in relation to each sex. 


hares_summary <- hare_data %>% 
  
  group_by(sex) %>% 
  summarize(
    mean_weight = mean(weight, na.rm = TRUE),
    sd_weight = sd(weight, na.rm = TRUE),
    sample_size = n(),
  
  )
hares_summary %>% 
  kable(col.names = c("Sex", "Mean Weight (gm)", "Standard Deviation (gm)", "Sample size")) %>% 
  kable_styling(bootstrap_options = "striped", full_width = FALSE)

```

Weight (all in grams) was compared across female and male trapped juveile snowshoe hares.  As expected and consistent with other studies, male hares had a heavier mean weight (`r hares_summary[2,2]` $\pm$ `r hares_summary[2,3]` mm, *n* = `r hares_summary[2,3]`; mean $\pm$ 1 standard deviation), compared to female hares (`r hares_summary[1,2]` $\pm$ `r hares_summary[1,3]` mm, *n* = `r hares_summary[1,4]`)(Table 1).

```{r, include= FALSE}
##Creating exploratory graphs to see if the weights for male, female, and N/A are normally distributed so that I may perform statistical tests with them. 

ggplot(data = hare_data, aes(x = weight)) +
  geom_histogram(bins = 15) +
  facet_wrap(~sex)

##The data appears to be fairly normally distributed (bell shaped) across male and female

ggplot(data = hare_data, aes(sample = weight)) +
  geom_qq() +
  facet_wrap(~sex)
##The data looks fairly linear. This linearity and the normal distribution seen in the histogram allow us to continue to run a t.test

```


```{r}
##Creating vectors to complete a two side t.test to compare the mean weights of male and female juvenile hares 

hares_new <- hare_data %>% 
  select("sex","weight")

hares_f <- hares_new %>% 
  filter(sex == "f") %>% 
  pull(weight)

hares_m <- hares_new %>% 
  filter(sex == "m") %>% 
  pull(weight)
```


```{r, include = FALSE}
##A two sided t.test to compare the mean weights of male and female juvenile hares. 
t.test(x = hares_f, y = hares_m)

```
```{r, include = FALSE}
## Completing a cohen.d test to examine the difference between the variance of points
cohen.d(hares_f, hares_m, na.rm = TRUE)
```

## Part 4:Relationship between Juvenile Weight & Hind Foot Lenth 
```{r}
##Creating a ggplot to look at the relationship between weight and hind foot length.A regression line was added.

hare_foot <- hares %>% 
 filter(age == "j")

ggplot(data = hare_foot, aes(x = weight, y = hindft)) +
  geom_jitter(color = "darkslategray4",size = 2, 
              alpha = 0.6,
              width = 0.1,
              show.legend = FALSE)+
   geom_smooth(method = "lm",
              color = "black",
              size = 0.5,
              fill = "gray10",
              alpha = 0.5) +
  theme_light() +
  ggpubr::stat_regline_equation(label.x = 1300, label.y = 100)
  

```
```{r, include = FALSE}
##Performing a Pearson's correlation tests between weight and hind foot size
hares_cor <- cor.test(hare_foot$weight, hare_foot$hindft)

hares_cor
```
moderate correlation 
```{r, include = FALSE}
## Retrieving the R-squared value
hares_lm <- lm(weight ~ hindft, data = hare_foot)

summary(hares_lm)
```
The Multiple R^2^ value is 0.2988 - meaning that 29.88% of variance in hindfoot length is explained by weight.

## Citations